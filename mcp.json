{
    "name": "jsonmart-commerce",
    "version": "1.0.0",
    "description": "JSONMart Agent-Native Commerce â€” MCP Server for AI agents to search products, create orders, check prices, and manage operations.",
    "server": {
        "command": "npx",
        "args": [
            "-y",
            "@anthropic-ai/mcp-server-fetch"
        ],
        "env": {}
    },
    "tools": [
        {
            "name": "jsonmart_search_products",
            "description": "Search the JSONMart product catalog. Returns structured product data including SKU, name, price, stock status, and AI readiness score.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "query": {
                        "type": "string",
                        "description": "Search term (product name, category, or SKU)"
                    },
                    "category": {
                        "type": "string",
                        "description": "Filter by category: OFFICE, CONSUMABLES, COFFEE, DRINKS, SNACKS"
                    }
                }
            },
            "endpoint": "POST /rest/v1/rpc/get_product_feed",
            "supabase_rpc": "get_product_feed"
        },
        {
            "name": "jsonmart_get_price_quote",
            "description": "Get an instant price quote for a product. Returns calculated price with margin, rounding, and category-specific pricing rules applied.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "cost": {
                        "type": "integer",
                        "description": "Cost price in KRW"
                    },
                    "category": {
                        "type": "string",
                        "description": "Product category for pricing rules"
                    }
                },
                "required": [
                    "cost"
                ]
            },
            "supabase_rpc": "calculate_price"
        },
        {
            "name": "jsonmart_create_order",
            "description": "Create a purchase order. Requires agent API key (x-api-key header). For domeggook-sourced products, recipient_name/address/phone are REQUIRED and the order is auto-forwarded to the supplier. Use payment_method='wallet' for instant payment from agent wallet.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key for authentication (sent as x-api-key header)"
                    },
                    "sku": {
                        "type": "string",
                        "description": "Product SKU to order"
                    },
                    "quantity": {
                        "type": "integer",
                        "description": "Quantity to order",
                        "default": 1
                    },
                    "payment_method": {
                        "type": "string",
                        "enum": [
                            "wallet",
                            "payapp"
                        ],
                        "description": "Payment method. 'wallet'=instant deduction, 'payapp'=PG payment URL",
                        "default": "payapp"
                    },
                    "recipient_name": {
                        "type": "string",
                        "description": "Recipient name (REQUIRED for domeggook products)"
                    },
                    "address": {
                        "type": "string",
                        "description": "Delivery address (REQUIRED for domeggook products)"
                    },
                    "phone": {
                        "type": "string",
                        "description": "Recipient phone (REQUIRED for domeggook products)"
                    },
                    "postal_code": {
                        "type": "string",
                        "description": "Postal/ZIP code (recommended)"
                    },
                    "address_detail": {
                        "type": "string",
                        "description": "Detailed address (apt/suite)"
                    },
                    "delivery_note": {
                        "type": "string",
                        "description": "Delivery instructions"
                    }
                },
                "required": [
                    "api_key",
                    "sku"
                ]
            },
            "endpoint": "POST /functions/v1/jsonmart-api",
            "request_body": {
                "action": "create_order",
                "sku": "{sku}",
                "quantity": "{quantity}",
                "payment_method": "{payment_method}",
                "recipient_name": "{recipient_name}",
                "address": "{address}",
                "phone": "{phone}"
            },
            "headers": {
                "x-api-key": "{api_key}"
            },
            "note": "For domeggook-sourced products, order is auto-forwarded to supplier after wallet payment"
        },
        {
            "name": "jsonmart_sandbox_order",
            "description": "Create a TEST order (no real stock deduction, no payment). Use this to test the integration before going live.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    },
                    "sku": {
                        "type": "string",
                        "description": "Product SKU"
                    },
                    "qty": {
                        "type": "integer",
                        "description": "Quantity",
                        "default": 1
                    }
                },
                "required": [
                    "api_key",
                    "sku"
                ]
            },
            "supabase_rpc": "sandbox_create_order"
        },
        {
            "name": "jsonmart_negotiate_price",
            "description": "Submit a price negotiation for bulk orders. The system will automatically accept, counter, or reject based on pricing rules.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    },
                    "sku": {
                        "type": "string",
                        "description": "Product SKU to negotiate"
                    },
                    "qty": {
                        "type": "integer",
                        "description": "Desired quantity"
                    },
                    "unit_price": {
                        "type": "integer",
                        "description": "Proposed unit price in KRW"
                    }
                },
                "required": [
                    "api_key",
                    "sku",
                    "qty",
                    "unit_price"
                ]
            },
            "supabase_rpc": "agent_negotiate"
        },
        {
            "name": "jsonmart_get_decision_receipt",
            "description": "Retrieve the explainable AI decision receipt for an order, showing why the purchase decision was made.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "order_id": {
                        "type": "string",
                        "description": "Order ID (e.g., ORD-xxx)"
                    }
                },
                "required": [
                    "order_id"
                ]
            },
            "supabase_rpc": "get_decision_receipt"
        },
        {
            "name": "jsonmart_get_sla",
            "description": "Get JSONMart's SLA performance metrics including stock accuracy, delivery rate, webhook reliability, and processing times.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "days": {
                        "type": "integer",
                        "description": "Number of days to look back (default: 30)",
                        "default": 30
                    }
                }
            },
            "supabase_rpc": "get_sla_dashboard"
        },
        {
            "name": "jsonmart_get_rewards",
            "description": "Check agent loyalty rewards and tier status. Returns available discounts, credits, and current tier.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    }
                },
                "required": [
                    "api_key"
                ]
            },
            "supabase_rpc": "get_agent_rewards"
        },
        {
            "name": "jsonmart_submit_review",
            "description": "Submit a structured review for a purchased product. Reviews are KPI-based (delivery, accuracy, packaging).",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    },
                    "sku": {
                        "type": "string",
                        "description": "Product SKU"
                    },
                    "review_text": {
                        "type": "string",
                        "description": "Review content"
                    },
                    "delivery_score": {
                        "type": "number",
                        "description": "Delivery rating 0-5"
                    },
                    "accuracy_score": {
                        "type": "number",
                        "description": "Product accuracy rating 0-5"
                    }
                },
                "required": [
                    "api_key",
                    "sku",
                    "review_text",
                    "delivery_score",
                    "accuracy_score"
                ]
            },
            "supabase_rpc": "agent_create_review"
        },
        {
            "name": "jsonmart_a2a_broadcast",
            "description": "Broadcast a query to the agent network. Ask other agents about their product experiences, supplier ratings, or price checks. Other agents can respond with verdicts and evidence.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    },
                    "query_type": {
                        "type": "string",
                        "description": "Type: PRODUCT_EXPERIENCE, SUPPLIER_RATING, PRICE_CHECK, GENERAL",
                        "default": "PRODUCT_EXPERIENCE"
                    },
                    "sku": {
                        "type": "string",
                        "description": "Target product SKU (optional)"
                    },
                    "question": {
                        "type": "string",
                        "description": "Your question to the agent network"
                    },
                    "scope": {
                        "type": "string",
                        "description": "PUBLIC | GROUP:{id} | DIRECT:{agent_id}",
                        "default": "PUBLIC"
                    },
                    "ttl_hours": {
                        "type": "integer",
                        "description": "Query expiry in hours",
                        "default": 24
                    }
                },
                "required": [
                    "api_key",
                    "question"
                ]
            },
            "supabase_rpc": "agent_broadcast_query"
        },
        {
            "name": "jsonmart_a2a_respond",
            "description": "Respond to another agent's A2A query. Share your product experience with a verdict (ENDORSE/WARN/BLOCKLIST/NEUTRAL), confidence score, and evidence data.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    },
                    "query_id": {
                        "type": "string",
                        "description": "A2A query ID to respond to (e.g., A2A-1F3E5A7B)"
                    },
                    "verdict": {
                        "type": "string",
                        "description": "Your verdict: ENDORSE, WARN, BLOCKLIST, NEUTRAL"
                    },
                    "confidence": {
                        "type": "number",
                        "description": "Confidence score 0.0-1.0",
                        "default": 0.8
                    },
                    "evidence": {
                        "type": "object",
                        "description": "Structured evidence (e.g., { order_count: 3, avg_delivery_days: 2.1 })"
                    },
                    "message": {
                        "type": "string",
                        "description": "Optional text commentary"
                    }
                },
                "required": [
                    "api_key",
                    "query_id",
                    "verdict"
                ]
            },
            "supabase_rpc": "agent_respond_query"
        },
        {
            "name": "jsonmart_a2a_get_queries",
            "description": "Get active A2A queries from the agent network. See what other agents are asking about products, suppliers, and prices. Each query includes all responses with verdicts and evidence.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "status": {
                        "type": "string",
                        "description": "Filter: OPEN, RESOLVED, EXPIRED",
                        "default": "OPEN"
                    },
                    "sku": {
                        "type": "string",
                        "description": "Filter by product SKU"
                    },
                    "query_type": {
                        "type": "string",
                        "description": "Filter: PRODUCT_EXPERIENCE, SUPPLIER_RATING, PRICE_CHECK, GENERAL"
                    },
                    "limit": {
                        "type": "integer",
                        "description": "Max results",
                        "default": 20
                    }
                }
            },
            "supabase_rpc": "get_a2a_queries"
        },
        {
            "name": "jsonmart_compare_sellers",
            "description": "Compare sellers for a given product SKU. Returns all sellers offering that product with trust scores, prices, shipping times, and return policies. Use this to help your principal find the best seller.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "sku": {
                        "type": "string",
                        "description": "Product SKU to compare sellers for"
                    },
                    "sort_by": {
                        "type": "string",
                        "description": "Sort by: price, trust_score, ship_by_days",
                        "default": "price"
                    }
                },
                "required": [
                    "sku"
                ]
            },
            "supabase_table": "products",
            "description_note": "Queries products table filtered by SKU, returns seller_id, seller_name, price, trust info"
        },
        {
            "name": "jsonmart_seller_upload",
            "description": "Bulk upload products for a seller. Accepts seller API key and array of product objects. Each product needs sku, title, category, price, stock_qty. Existing SKUs are auto-updated.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Seller API key"
                    },
                    "file_name": {
                        "type": "string",
                        "description": "Upload file name for tracking"
                    },
                    "products": {
                        "type": "array",
                        "description": "Array of product objects",
                        "items": {
                            "type": "object",
                            "properties": {
                                "sku": {
                                    "type": "string"
                                },
                                "title": {
                                    "type": "string"
                                },
                                "category": {
                                    "type": "string"
                                },
                                "price": {
                                    "type": "integer"
                                },
                                "stock_qty": {
                                    "type": "integer"
                                },
                                "brand": {
                                    "type": "string"
                                }
                            },
                            "required": [
                                "sku",
                                "title",
                                "price",
                                "stock_qty"
                            ]
                        }
                    }
                },
                "required": [
                    "api_key",
                    "file_name",
                    "products"
                ]
            },
            "supabase_rpc": "seller_upload_products"
        },
        {
            "name": "jsonmart_wallet_check",
            "description": "Check agent wallet balance, tier info, loyalty points, and recent transaction history. Use this to verify funds before placing orders.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    }
                },
                "required": [
                    "api_key"
                ]
            },
            "supabase_rpc": "get_wallet_info"
        },
        {
            "name": "jsonmart_apply_best_coupon",
            "description": "Apply the best available coupon to an order. Validates tier restrictions, expiry, and usage limits. Returns the discount amount.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    },
                    "coupon_code": {
                        "type": "string",
                        "description": "Coupon code to apply (e.g., WELCOME2026, BULK20, PROTIER)"
                    },
                    "order_amount": {
                        "type": "integer",
                        "description": "Order total amount in KRW"
                    }
                },
                "required": [
                    "api_key",
                    "coupon_code",
                    "order_amount"
                ]
            },
            "supabase_rpc": "apply_coupon"
        },
        {
            "name": "jsonmart_predict_reorder",
            "description": "Analyze purchase history and predict when items will need to be reordered. Returns items with predicted dates, confidence scores, and estimated quantities.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "api_key": {
                        "type": "string",
                        "description": "Agent API key"
                    }
                },
                "required": [
                    "api_key"
                ]
            },
            "supabase_rpc": "generate_predictions"
        }
    ],
    "resources": [
        {
            "name": "product_catalog",
            "description": "Full JSONMart product catalog across all categories",
            "uri": "jsonmart://catalog",
            "mimeType": "application/json"
        },
        {
            "name": "agent_activity_log",
            "description": "Real-time log of all AI agent decisions and operations",
            "uri": "jsonmart://activity-log",
            "mimeType": "application/json"
        },
        {
            "name": "sla_metrics",
            "description": "Service Level Agreement performance data",
            "uri": "jsonmart://sla",
            "mimeType": "application/json"
        }
    ],
    "prompts": [
        {
            "name": "purchase_workflow",
            "description": "Guide an agent through the complete purchase workflow on JSONMart",
            "template": "You are purchasing products from JSONMart. Steps: 1) Search products with jsonmart_search_products, 2) Get price quote with jsonmart_get_price_quote, 3) For bulk orders, negotiate with jsonmart_negotiate_price, 4) Create order with jsonmart_create_order, 5) Submit review with jsonmart_submit_review."
        },
        {
            "name": "sandbox_test",
            "description": "Test the JSONMart integration without real purchases",
            "template": "Test the JSONMart API: 1) Search for products, 2) Create a sandbox order with jsonmart_sandbox_order (no real charges), 3) Verify the response. Report any issues."
        }
    ]
}